<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Urban Culture - Tokyo</title>
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.css" rel="stylesheet" />
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.js"></script>
  <script src="https://d3js.org/d3.v6.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6/turf.min.js"></script>
  <link rel="stylesheet" href="urban_tokyo.css" />
</head>

<body>
  <!-- 顶部导航 -->
  <nav class="navbar">
    <ul class="navbar-menu">
      <li><a href="#">Home</a></li>
      <li><a href="#">Introduction</a></li>
      <li><a href="#">Trade</a></li>
      <li class="dropdown">
        <a class="active" href="#">Culture ▾</a>
        <ul class="dropdown-menu">
          <li><a href="#" onclick="selectCity('Guangzhou')">Guangzhou</a></li>
          <li><a href="#" onclick="selectCity('Melbourne')">Melbourne</a></li>
          <li><a href="#" onclick="selectCity('Rome')">Rome</a></li>
          <li><a href="#" onclick="selectCity('Tokyo')">Tokyo</a></li>
        </ul>
      </li>
      <li><a href="#">Conclusion</a></li>
      <li><a href="#">About</a></li>
    </ul>
  </nav>

  <!-- 主容器 -->
  <div id="urban-container">
    
    <!-- 地图区域 -->
    <div id="map-area">
      <div id="map"></div>

      <!-- 左侧三个可折叠卡片 -->
      <div id="map-left-panel">

        <!-- 统计图 -->
        <div class="collapsible-card">
          <div class="card-header no-collapse">
            <span class="card-title">Statistics</span>
          </div>
          <div class="card-body" id="chart-panel">
            <canvas id="coffee-stats-chart"></canvas>
            <div id="chart-caption">Hover over bars to see exact café counts</div>
          </div>
        </div>

        <!-- 图层开关 -->
        <div class="collapsible-card">
          <div class="card-header">
            <span class="card-title">Layers</span>
            <span class="arrow">▼</span>
          </div>
          <div class="card-body" id="layer-toggle-panel">
           <label><input type="checkbox" class="layer-toggle" data-type="Chain" checked /> Chain</label><br />
           <label><input type="checkbox" class="layer-toggle" data-type="Independent" checked /> Independent</label><br />
           <label><input type="checkbox" class="layer-toggle" data-type="Community/Old-fashioned" checked /> Community/Old-fashioned</label><br />
          </div>
        </div>

        <!-- 图例 -->
        <div class="collapsible-card">
          <div class="card-header">
            <span class="card-title">Legend</span>
            <span class="arrow">▼</span>
          </div>
          <div class="card-body" id="legend-panel">
            <div class="legend-item"><span class="legend-color" style="background-color: #b1150c;"></span> Chain</div>
            <div class="legend-item"><span class="legend-color" style="background-color: #7E8EA5;"></span> Independent</div>
            <div class="legend-item"><span class="legend-color" style="background-color: #5E382F;"></span> Community/Old-fashioned</div>

            <!-- heatmap 图例：不再套在 legend-item 内 -->
            <div class="heat-legend">
              <div class="legend-label">Heat Intensity</div>
              <div class="heat-gradient-bar"></div>
              <div class="heat-labels">
                <span>Low</span>
                <span>High</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 视图重启 -->
      <button id="reset-view-btn">
      ⟲ Reset View
      </button>

      <!-- 底部信息文字 -->
      <div id="info-text">
        <!-- JS will dynamically inject content here -->
      </div>

      <!-- 行政区 Hover 显示 -->
      <div id="hover-label"></div>
    </div>

<!-- 右侧面板 -->
<div id="right-panel">
  <div id="city-panel">

    <!-- Top 拼贴图 + 所有文字浮层 -->
    <div class="city-collage-wrapper top-wrapper">
      <img src="image/TOYKO/toyko_top.png" alt="Tokyo Collage Top" class="city-collage-img">

      <div id="city-text-overlay">
        <p class="city-section-title">Tokyo - Precision and Pause</p>
        <p>In Tokyo, coffee does not shout — it is measured. From corporate corridors in Shinjuku to narrow alleys in Setagaya, cafés serve as structured intermissions in a city of flow.</p>
        <p>Chain cafés gather near transit hubs and shopping belts — Shibuya, Ikebukuro, Ueno — where speed meets routine.</p>
        <p>Independent cafés prefer breathing space: creative districts, student zones, and residential neighborhoods.</p>
        <p>Community-style cafés linger further out — Arakawa, Katsushika — where slow rhythms, local memory, and older architecture invite longer pauses.</p>
        <p>Tokyo's coffee culture is plural yet precise — a map of rituals stitched into the city's layered pace.</p>
        <div id="zoom-buttons">
          <button id="btn-tokyo">Tokyo</button>
          <button id="btn-aoyama">Aoyama</button>
        </div>
      </div>
    </div>

    <!-- Bottom 拼贴图 -->
    <div class="city-collage-wrapper bottom-wrapper">
      <img src="image/TOYKO/toyko_bottom.png" alt="Tokyo Collage Bottom" class="city-collage-img">
    </div>
  </div>
</div>

  <!-- 主脚本入口 -->
  <script src="urban_tokyo_map.js"></script>
</body>
</html>
